<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Thanh toán</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
</head>
<body class="container mt-5">

<h3 class="mb-4">Thanh toán</h3>

<form th:action="@{/gia-lap-thanh-toan}" method="post">
    <input type="hidden" name="idLichDatSan" th:value="${idLichDatSan}"/>

    <label>Phương thức thanh toán</label>
    <select id="phuongThucSelect" name="idPhuongThucThanhToan" class="form-select" required>
        <option th:each="pt : ${dsPhuongThuc}"
                th:value="${pt.idPhuongThucThanhToan}"
                th:text="${pt.tenPhuongThucThanhToan}">
        </option>
    </select>

    <!-- Mã QR chỉ hiện nếu KHÔNG phải tiền mặt -->
    <div id="qrCodeSection" style="margin-top: 20px; display: none;">
        <p><strong>Quét mã QR để thanh toán:</strong></p>
        <img src="/image/QRThanhToan.jpg" alt="QR thanh toán"
             style="max-width: 300px; border-radius: 8px; border: 1px solid #ccc; padding: 5px;"/>
    </div>

    <button type="submit" class="btn btn-success mt-3">Xác nhận thanh toán</button>
</form>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        const select = document.getElementById("phuongThucSelect");
        const qrDiv = document.getElementById("qrCodeSection");

        select.addEventListener("change", function () {
            const selectedId = select.value;

            // Nếu KHÔNG phải tiền mặt (ID != 1) → hiện QR
            if (selectedId && selectedId !== "1") {
                qrDiv.style.display = "block";
            } else {
                qrDiv.style.display = "none";
            }
        });

        // Gọi sự kiện ban đầu nếu option được chọn sẵn
        select.dispatchEvent(new Event("change"));
    });
</script>
</body>
</html>
